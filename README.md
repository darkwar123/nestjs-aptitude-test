# –¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é Backend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (NestJS, TypeScript)

## –û–ø–∏—Å–∞–Ω–∏–µ

–†–∞–∑—Ä–∞–±–æ—Ç–∞–π—Ç–µ REST API —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NestJS –∏ TypeScript. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—Ä–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞–Ω–∏—è, –∫–∞–∂–¥–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ü–µ–ª–µ–Ω–æ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —Å—Ç–µ–∫ –Ω–∞–≤—ã–∫–æ–≤. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–±–æ—á–∏–π –∫–æ–¥, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏–π –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –∑–∞–¥–∞–Ω–∏—è, –∏ –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.

---

## 1. **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ –¥–≤—É—Ö —Å–ø–∏—Å–∫–æ–≤**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–†–µ–∞–ª–∏–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–≤–∞ –º–∞—Å—Å–∏–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –ø–æ–ª–µ –¥–ª—è —Å–≤—è–∑—ã–≤–∞–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö:**

* **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

  ```json
  {
    "left": [
      { "id": 1, "name": "Ivan" },
      { "id": 2, "name": "John" }
    ],
    "right": [
      { "userId": 2, "city": "London" },
      { "userId": 1, "city": "Moscow" }
    ],
    "leftKey": "id",
    "rightKey": "userId"
  }
  ```

* **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

  ```json
  [
    { "id": 1, "name": "Ivan", "city": "Moscow" },
    { "id": 2, "name": "John", "city": "London" }
  ]
  ```

---

## 2. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ AcceptLanguage –∏ DeviceId**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–≤–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ NestJS:

1. **AcceptLanguage**

   * –ß–∏—Ç–∞–µ—Ç —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `accept-language` (–Ω–∞–ø—Ä–∏–º–µ—Ä: `ru`, `en`, `en-US`).
   * –ü–µ—Ä–µ–¥–∞—ë—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –≤ –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.

2. **DeviceId**

   * –ò–∑–≤–ª–µ–∫–∞–µ—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `x-device-id`.
   * –ï—Å–ª–∏ —Ö—ç–¥–µ—Ä –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ IP‚Äë–∞–¥—Ä–µ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–º –∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ IP‚Äë–∞–¥—Ä–µ—Å–∞).
   * –ü–µ—Ä–µ–¥–∞—ë—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä.

**–ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞:**

```http
GET /profile
accept-language: ru,en-US;q=0.9,en;q=0.8,zh-CN;q=0.7,zh;q=0.6
x-device-id: 123e4567-e89b-12d3-a456-426614174000
```

**–ü—Ä–∏–º–µ—Ä –º–µ—Ç–æ–¥–∞:**

```typescript
@Get('profile')
getProfile(
  @AcceptLanguage() lang: string,
  @DeviceId() deviceId: string,
) {
  return { lang, deviceId };
}
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**

```json
{
  "lang": "ru",
  "deviceId": "123e4567-e89b-12d3-a456-426614174000"
}
```

* –ï—Å–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `x-device-id` –Ω–µ—Ç, –≤–µ—Ä–Ω–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UUID –Ω–∞ –æ—Å–Ω–æ–≤–µ IP‚Äë–∞–¥—Ä–µ—Å–∞.

---

## 3. **–í–∞–ª–∏–¥–∞—Ü–∏—è URL —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º –Ω–∞ origin**

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞, –ø—Ä–∏–Ω–∏–º–∞—é—â–∏–π –≤ —Ç–µ–ª–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª–µ url.
–¢—Ä–µ–±—É–µ—Ç—Å—è –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å, —á—Ç–æ origin –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ url —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –¥–æ–ø—É—Å—Ç–∏–º–æ–º –º–∞—Å—Å–∏–≤–µ, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞.

**–ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:**

* **–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞:**

  ```typescript
  @Post('validate-url')
  validateUrl(
    @Body() dto: ValidateUrlDto,
  ) {
    return { ok: true };
  }
  ```

* **DTO:**

  ```typescript
  class ValidateUrlDto {
    @IsAllowedOrigin(['https://myapp.com', 'https://test.com'])
    url: string;
  }
  ```

* **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

  ```json
  { "url": "https://myapp.com/api/data" }
  ```

* **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–µ—Å–ª–∏ origin –¥–æ–ø—É—Å—Ç–∏–º):**

  ```json
  { "ok": true }
  ```

* **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–µ—Å–ª–∏ origin –Ω–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–ø–∏—Å–æ–∫):**

  ```json
  {
    "statusCode": 400,
    "message": [
		"url origin is not allowed"
	],
    "error": "Bad Request"
  }
  ```

**–ö—Ä–∏—Ç–µ—Ä–∏–∏:**

* –ü—Ä–æ–≤–µ—Ä–∫–∞ origin –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å—Ç—Ä–æ–≥–æ —á–µ—Ä–µ–∑ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä.
* –í–∞–ª–∏–¥–∞—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞—Å—à–∏—Ä—è–µ–º—ã–º –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º.

---

## üìÑ **–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é**

* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π TypeScript (ES2021+), NestJS (>=9).
* –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç —Å–æ–≥–ª–∞—Å–Ω–æ best practice NestJS.
* –ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π endpoint.

---
